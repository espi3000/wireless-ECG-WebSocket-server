<!DOCTYPE HTML><html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.highcharts.com/highcharts.js"></script>
</head>
<body>
    <div id="chart-ecg" class="container"></div>
</body>
<script>
    // https://api.highcharts.com/highcharts/
    let ecg_chart = new Highcharts.Chart({
        chart: {
            renderTo : 'chart-ecg'
        },
        title: {
            text: 'ECG'
        },
        series: [{
            showInLegend: false,
            data: []
        }],
        plotOptions: {
            series: {
                color: '#059e8a',
                marker: {
                    enabled: false
                }
            }
        },
        xAxis: {
            type: 'datetime',
            dateTimeLabelFormats: {
                second: '%H:%M:%S'
            }
        },
        yAxis: {
            title: {
                text: 'Voltage [V]'
            }
        }
    });

    let websocket = new WebSocket('ws://'+window.location.hostname+':81/');
    websocket.onmessage = function(event) {
        let x = (new Date()).getTime();
        let y = JSON.parse(event.data).ECG;
        if(ecg_chart.series[0].data.length > 500) { // Limit amount of data visible
            ecg_chart.series[0].addPoint([x, y], true, true, false);
        } else {
            ecg_chart.series[0].addPoint([x, y], true, false, false);
        }
    }
</script>
</html>